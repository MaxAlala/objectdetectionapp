<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Object detection and grasping application: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Object detection and grasping application
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Object detection and grasping application Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This application can be taught to detect and capture specific objects. The main algorithm is d2co. It also creates a 3d point cloud. Currently, you need a ZED camera to start this application. Tutorial how to install all dependencies and this application u can find here: link to install tutorial! Two articles that describe D2CO algorithm: 1 article 2 article bitbucket of the algorithm( source code, a bit of description etc): default algorithm source code Source code of this application can be found here: app source what is important to understand? The main files that run the program (the rest of the files describe the operation of the d2c0 algorithm): objectdetectionapp/apps: <a class="el" href="generate__models_8cpp.html" title="in this application : You create model data base changing an object orientation and position...">generate_models.cpp</a> frame_tf_broadcaster.cpp <a class="el" href="detect__object_8cpp.html" title="in this application : 1) you take an image and chose its ROI(region of interest) to specify area to i...">detect_object.cpp</a> objectdetectionapp/include: <a class="el" href="InteractiveMarkerRos_8h_source.html">InteractiveMarkerRos.h</a> <a class="el" href="opencv_8h_source.html">opencv.h</a> CMakeLists.txt HOW TO LAUNCH THE APPLICATION: Firstly, u should install the application using the link above. Secondly, you should create a model file using generate_model executable file: Example: ./generate_models -m 3D_models/toGrasp.stl -c test_images/test_camera_calibHD.yml -p fileHD.yml -i saved_images/image.png -s 1 &ndash;d_rp 5 &ndash;rp_s 5 &ndash;d_yaw 5 &ndash;yaw_s 5 &ndash;d_z 0.1 &ndash;z_s 0.05</p>
<p>after u should start these:</p>
<p>roscore</p>
<p>rosrun rviz rviz</p>
<p>./frame_tf_broadcaster</p>
<p>./detect_object -m fileHD.yml -c test_images/test_camera_calibHD.yml -d saved_images -o VIDEO -s 1</p>
<p>in rviz u should add:</p>
<p>PointCloud2 with topic poincloud</p>
<p>interactiveMarker</p>
<p>Marker</p>
<p>TF Fixed Frame is "map".</p>
<p>Also an example of working with this application u can find in the video below: video example in detail: how the whole application works:</p>
<p>after succesfull creation of model file using generate_model executable For example, launch command is: ./generate_models -m 3D_models/toGraps.stl -c test_images/test_camera_calibHD.yml -p fileHD.yml -i saved_images/image.png -s 1 &ndash;d_rp 5 &ndash;rp_s 5 &ndash;d_yaw 5 &ndash;yaw_s 5 &ndash;d_z 0.1 &ndash;z_s 0.05</p>
<p>where "--d_rp" specifies roll &amp; pitch distance to reach, "--rp_s" specifies a step size. Similar idea with d_z and d_yaw.</p>
<p>after u should start these auxiliary programs:</p>
<p>roscore // it creates main controller of ROS nodes</p>
<p>rosrun rviz rviz // it launches RVIZ program for visualization in rviz u should add: a) PointCloud2 with topic poincloud b) interactiveMarker c) Marker d) TF Fixed Frame is "map".</p>
<p>./frame_tf_broadcaster // it creates topic which sends camera frame data to the RVIZ</p>
<p>./detect_object -m fileHD.yml -c test_images/test_camera_calibHD.yml -d saved_images -o VIDEO -s 1</p>
<p>./detect_object:</p>
<p>you take an image and chose its ROI(region of interest) to specify area to improve speed and d2c0 algorithm detection quality)</p>
<p>algorithm works, detects the best matching object and displays it in a window</p>
<p>you can accept a detected object then opencv object will create two RVIZ Markers(interactive and not)using orientation and location, pointcloud also opencv object will calculate a tool orientation and set it to the global variable to send it to the robot</p>
<p>if u deny an detected object, u can repeat an attempt 2 more times. Also u can finish the program and start all from beginning.</p>
<p>So then u choose a detected object and sent it to the RVIZ here you can click on the right mouse button on the detected object model and chose to start the socket to send tool orientation( ABC-ZYX Euler angles) to the robot. on the robot you must run the corresponding program - it will create server which will listen incoming connections. When connection happens, robot will start an object grapsing process. It will lift it and after put it on the floor.</p>
<p>Idea how to find tool orientation using detected object orientation: <br />
</p>
<p>// Robot tool orientation is expressed in map frame. So detected object orientation also expressed <br />
 // in map frame. <br />
 // here is our goal to find out an angle to rotate the tool to grasp the detected object <br />
 // 1) we suppose that tool has the same orientation as the detected object, for example, this is our object and its XZ axes <br />
 // ^ Z <br />
 // | <br />
 // ---------&mdash; <br />
 // |    | <br />
 // ---------&mdash; ---&mdash;&gt; X <br />
 // To grasp an object we need to orient our tool so that it was directed toward our object and the grasping gap of the tool was directed rightly <br />
 // |--&mdash;| <br />
 // | &#160;&#160;&#160;&#160;&#160;|*X == X axis directed toward us <br />
 // |_| |_| this is our tool <br />
 // | <br />
 // | <br />
 // | <br />
 // \/ Z <br />
 // 2) as we can see, our single goal to make tool Z be directed in opposite direction to Z of the object, and then a tool <br />
 // will easily grasp a detected object <br />
 // so we can find the angle between Z and tool's Z_1 using dot product from a rotation matrix <br />
 // and we will rotate this angle around X-axis so our Z &amp; Z_1 will be directed in the opposite directions. <br />
 // 3) final thing to do is to define the sign of angle between Z and Z_1 to rotate around X <br />
 // We can define it with respect to Y1_Z, if the dot product is less then zero then we change sign, else do nothing <br />
 // 4) Tool orientation is ready. <br />
 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
